package com.example.service;import java.io.BufferedReader;import java.io.BufferedWriter;import java.io.IOException;import java.io.InputStream;import java.io.InputStreamReader;import java.io.OutputStreamWriter;import java.net.InetAddress;import java.net.Socket;import java.net.UnknownHostException;import android.app.Service;import android.content.Intent;import android.os.Handler;import android.os.IBinder;import android.os.Message;import android.util.Log;import android.widget.Toast;public class ClientNetService extends Service{	public static Thread NetThread;	public static Socket socket;	public static BufferedWriter bw = null;	public static InputStream br = null;	public static ClientSocketIOWriteNet writerThread = null;	public static Intent serviceIntent;	@Override	public IBinder onBind(Intent intent) {		// TODO Auto-generated method stub		return null;	}	private Handler handler = new Handler() {		@Override		public void handleMessage(Message msg) {			super.handleMessage(msg);			switch (msg.what) {			case 200:				Toast.makeText(getApplication(), "连接成功 ", Toast.LENGTH_SHORT)						.show();			//	 new Thread(new WriterThread(socket)).start();								break;			case 404:				Toast.makeText(getApplication(), "服务未连接", Toast.LENGTH_SHORT)						.show();				NetListenerUtil.clostAllNet(ClientNetService.this);				//NetThread = null;				//socket = null;				break;			}		}	};	@Override	public int onStartCommand(Intent intent, int flags, int startId) {		if (NetThread == null || socket == null) {			NetThread = new Thread(new Runnable() {				@Override				public void run() {					connSocket();				}			});			NetThread.start();		}		return super.onStartCommand(intent, flags, startId);	}			private void connSocket() {		if (socket == null) {			try {			   				socket = new Socket(BroadcastFinal.CONNECTSOCKET, 9000);				socket.setSoTimeout(5000);					bw = new BufferedWriter(new OutputStreamWriter(							socket.getOutputStream()));					/*br = new BufferedReader(new InputStreamReader(							socket.getInputStream()));*/					br = socket.getInputStream();					writerThread = new ClientSocketIOWriteNet(ClientNetService.this);					try{					ClientNetService.writerThread.start();					}catch(Exception e){						e.printStackTrace();					}					if(ClientNetService.writerThread!=null){					// 写						ClientNetService.writerThread.SetStr("");					//读						ClientNetService.writerThread.getStr();					}					if (ClientNetService.writerThread != null) {						ClientNetService.writerThread.setInitBooleanMain(true);					}							} catch (Exception e) {				 Message msgs3 = Message.obtain();				msgs3.what = 404;				handler.sendMessage(msgs3);			}		}	}}